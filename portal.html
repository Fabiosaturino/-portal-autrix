<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Agendamento | Autrix</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a14 0%, #0d1525 50%, #111d35 100%);
            min-height: 100vh;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(59, 130, 246, 0.03) 50%, transparent 51%),
                linear-gradient(0deg, transparent 49%, rgba(59, 130, 246, 0.03) 50%, transparent 51%);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-img {
            max-width: 200px;
            height: auto;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .glow-line {
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
            margin: 15px auto;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header p {
            font-size: 1rem;
            color: #64748b;
            letter-spacing: 2px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 20px;
            font-size: 0.85rem;
            font-weight: 600;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(59, 130, 246, 0.1);
            color: #94a3b8;
            backdrop-filter: blur(10px);
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn img {
            width: 20px;
            height: 20px;
        }

        .tab-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            color: #fff;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border-color: #3b82f6;
            color: #fff;
            box-shadow: 0 5px 25px rgba(59, 130, 246, 0.4);
        }

        .content-area {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 16px;
            padding: 30px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-title {
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: #fff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-group label .required {
            color: #ef4444;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            font-size: 1rem;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.8);
            color: #fff;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        .form-control::placeholder {
            color: #475569;
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        select.form-control {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2394a3b8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
            max-height: 400px;
        }

        .expand-btn {
            display: inline-block;
            margin-top: 8px;
            padding: 6px 12px;
            font-size: 0.8rem;
            color: #60a5fa;
            background: transparent;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .expand-btn:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .phone-input-group {
            display: flex;
            align-items: center;
            width: 100%;
        }

        .phone-prefix {
            padding: 14px 12px;
            font-size: 1rem;
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-right: none;
            border-radius: 8px 0 0 8px;
            color: #3b82f6;
            font-weight: 600;
            flex-shrink: 0;
        }

        .phone-input-group .form-control {
            border-radius: 0 8px 8px 0;
            flex: 1;
            min-width: 0;
        }

        .btn-buscar-dest {
            width: 100%;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            border: none;
            padding: 14px 16px;
            font-size: 0.85rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 12px;
        }

        .btn-buscar-dest:hover {
            background: linear-gradient(135deg, #1e3a8a, #2563eb);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .destinatarios-filtros {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .destinatarios-filtros .form-control {
            flex: 1;
            min-width: 150px;
        }

        .filtro-btns {
            display: flex;
            gap: 5px;
        }

        .filtro-btn {
            background: #334155;
            color: #94a3b8;
            border: none;
            padding: 10px 14px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filtro-btn:hover {
            background: #475569;
        }

        .filtro-btn.active {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
        }

        .destinatarios-list {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .destinatario-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #0f172a;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .destinatario-item:hover {
            background: #1e3a5f;
        }

        .destinatario-item.selected {
            background: #1e40af;
            border: 1px solid #3b82f6;
        }

        .destinatario-item input[type="checkbox"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
        }

        .destinatario-info {
            flex: 1;
        }

        .destinatario-nome {
            font-weight: 500;
            color: #f1f5f9;
        }

        .destinatario-numero {
            font-size: 0.8rem;
            color: #64748b;
        }

        .destinatario-tipo {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            background: #334155;
            color: #94a3b8;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .btn-submit {
            width: 100%;
            padding: 16px;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: #fff;
            box-shadow: 0 5px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.5);
        }

        .btn-submit:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .alert-success {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #22c55e;
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 0.8s linear infinite;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #475569;
            font-size: 0.85rem;
        }

        .footer a {
            color: #3b82f6;
            text-decoration: none;
        }

        .time-picker-container {
            position: relative;
        }

        .time-picker-input {
            width: 100%;
            padding: 14px 16px;
            font-size: 1rem;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.8);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-picker-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        .time-picker-input::placeholder {
            color: #475569;
        }

        .time-picker-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            margin-top: 5px;
            background: rgba(15, 23, 42, 0.98);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            z-index: 100;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .time-picker-dropdown.open {
            display: block;
        }

        .time-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
        }

        .time-picker-header span {
            color: #94a3b8;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .time-picker-close {
            background: none;
            border: none;
            color: #64748b;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
        }

        .time-picker-close:hover {
            color: #fff;
        }

        .time-picker-columns {
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
        }

        .time-column {
            flex: 1;
            max-width: 100px;
        }

        .time-column-label {
            text-align: center;
            color: #64748b;
            font-size: 0.75rem;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .time-scroll {
            height: 150px;
            overflow-y: auto;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            background: #ffffff;
            scrollbar-width: thin;
            scrollbar-color: #3b82f6 #e5e7eb;
        }

        .time-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .time-scroll::-webkit-scrollbar-track {
            background: #e5e7eb;
        }

        .time-scroll::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 3px;
        }

        .time-option {
            padding: 10px;
            text-align: center;
            color: #3b82f6;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .time-option:hover {
            background: rgba(59, 130, 246, 0.15);
            color: #1e40af;
        }

        .time-option.selected {
            background: #3b82f6;
            color: #fff;
            font-weight: 600;
        }

        .time-separator {
            font-size: 2rem;
            color: #3b82f6;
            font-weight: bold;
        }

        .time-picker-confirm {
            margin-top: 15px;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .time-picker-confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .dashboard-search {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .dashboard-search .phone-input-group {
            width: 100%;
        }

        .dashboard-search .phone-input-group .form-control {
            width: 100%;
        }

        .dashboard-search .btn-submit {
            width: 100%;
            padding: 14px 30px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 5px;
        }

        .stat-card .stat-label {
            font-size: 0.8rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card.success .stat-value {
            color: #22c55e;
        }

        .stat-card.error .stat-value {
            color: #ef4444;
        }

        /* Charts */
        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .chart-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .chart-card h3 {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .chart-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .chart-tab {
            padding: 8px 16px;
            font-size: 0.8rem;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 6px;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chart-tab:hover {
            background: rgba(59, 130, 246, 0.2);
            color: #fff;
        }

        .chart-tab.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: #fff;
        }

        .chart-wrapper {
            height: 200px;
            position: relative;
        }

        /* Recorr√™ncia */
        .recorrencia-options {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
        }

        .recorrencia-options.show {
            display: block;
        }

        .dias-semana-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .dia-semana-btn {
            padding: 10px 12px;
            min-width: 45px;
            text-align: center;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 6px;
            color: #94a3b8;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .dia-semana-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            color: #fff;
        }

        .dia-semana-btn.selected {
            background: #3b82f6;
            border-color: #3b82f6;
            color: #fff;
        }

        .dia-mes-input {
            width: 80px;
            text-align: center;
        }

        /* ========== ESTILOS GERENCIAR AGENDADOS ========== */
        .agendamento-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .agendamento-card:hover {
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .agendamento-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .agendamento-id {
            color: #64748b;
            font-size: 0.85rem;
        }

        .agendamento-status {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pendente {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .status-pausado {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px dashed #fbbf24;
        }

        .status-processando {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .status-enviado {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .status-erro {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .agendamento-mensagem {
            color: #e2e8f0;
            font-size: 1rem;
            margin-bottom: 10px;
            word-break: break-word;
            line-height: 1.5;
        }

        .agendamento-imagem {
            margin: 10px 0;
        }

        .agendamento-imagem img {
            max-width: 150px;
            max-height: 100px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .agendamento-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            font-size: 0.8rem;
            color: #64748b;
            margin-bottom: 15px;
        }

        .agendamento-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .agendamento-acoes {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-acao {
            padding: 8px 16px;
            font-size: 0.8rem;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-pausar {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .btn-pausar:hover {
            background: rgba(251, 191, 36, 0.3);
        }

        .btn-reativar {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .btn-reativar:hover {
            background: rgba(34, 197, 94, 0.3);
        }

        .btn-excluir {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .btn-excluir:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .btn-acao:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #64748b;
            border: 1px dashed rgba(59, 130, 246, 0.3);
            border-radius: 12px;
        }

        .empty-state p {
            margin-bottom: 10px;
        }

        /* Modal de Confirma√ß√£o */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #0d1525, #111d35);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 16px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #fff;
        }

        .modal-text {
            color: #94a3b8;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 25px;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn-cancel {
            background: rgba(100, 116, 139, 0.2);
            color: #94a3b8;
            border: 1px solid rgba(100, 116, 139, 0.3);
        }

        .modal-btn-cancel:hover {
            background: rgba(100, 116, 139, 0.3);
        }

        .modal-btn-confirm {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: #fff;
        }

        .modal-btn-confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.4);
        }

        /* Filtros de Status */
        .filtros-status {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filtro-status-btn {
            padding: 8px 14px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(59, 130, 246, 0.1);
            color: #94a3b8;
        }

        .filtro-status-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            color: #fff;
        }

        .filtro-status-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: #fff;
        }

        @media (max-width: 600px) {
            .form-row {
                flex-direction: column;
            }

            .tabs {
                gap: 8px;
            }

            .tab-btn {
                padding: 10px 15px;
                font-size: 0.75rem;
            }

            .tab-btn img {
                width: 16px;
                height: 16px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .agendamento-acoes {
                flex-direction: column;
            }

            .btn-acao {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="data:image/webp;base64,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" alt="AUTRIX" class="logo-img">
            <div class="glow-line"></div>
            <p>PORTAL DE AGENDAMENTO</p>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('destinatarios', this)">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogIDxjaXJjbGUgY3g9IjMyIiBjeT0iMTgiIHI9IjgiLz4KICA8cGF0aCBkPSJNMjAgNTIgUTIwIDM2IDMyIDM2IFE0NCAzNiA0NCA1MiIvPgogIDxjaXJjbGUgY3g9IjE0IiBjeT0iMjQiIHI9IjYiLz4KICA8cGF0aCBkPSJNNCA1MiBRNCA0MCAxNCA0MCBRMjAgNDAgMjIgNDQiLz4KICA8Y2lyY2xlIGN4PSI1MCIgY3k9IjI0IiByPSI2Ii8+CiAgPHBhdGggZD0iTTYwIDUyIFE2MCA0MCA1MCA0MCBRNDQgNDAgNDIgNDQiLz4KPC9zdmc+Cg==" alt="">
                CADASTRO
            </button>
            <button class="tab-btn" onclick="switchTab('agendar', this)">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogIDxyZWN0IHg9IjgiIHk9IjEyIiB3aWR0aD0iNDgiIGhlaWdodD0iNDQiIHJ4PSI0Ii8+CiAgPGxpbmUgeDE9IjgiIHkxPSIyNCIgeDI9IjU2IiB5Mj0iMjQiLz4KICA8bGluZSB4MT0iMjAiIHkxPSI0IiB4Mj0iMjAiIHkyPSIyMCIvPgogIDxsaW5lIHgxPSI0NCIgeTE9IjQiIHgyPSI0NCIgeTI9IjIwIi8+CiAgPGNpcmNsZSBjeD0iMzIiIGN5PSI0MCIgcj0iOCIvPgogIDxwYXRoIGQ9Ik0zMiAzNiBMMzIgNDAgTDM2IDQwIi8+Cjwvc3ZnPgo=" alt="">
                AGENDAR / ENVIAR
            </button>
            <button class="tab-btn" onclick="switchTab('gerenciar', this)">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogIDxyZWN0IHg9IjgiIHk9IjgiIHdpZHRoPSI0OCIgaGVpZ2h0PSIxMiIgcng9IjIiLz4KICA8cmVjdCB4PSI4IiB5PSIyNiIgd2lkdGg9IjQ4IiBoZWlnaHQ9IjEyIiByeD0iMiIvPgogIDxyZWN0IHg9IjgiIHk9IjQ0IiB3aWR0aD0iNDgiIGhlaWdodD0iMTIiIHJ4PSIyIi8+CiAgPGNpcmNsZSBjeD0iMTYiIGN5PSIxNCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KICA8Y2lyY2xlIGN4PSIxNiIgY3k9IjMyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgogIDxjaXJjbGUgY3g9IjE2IiBjeT0iNTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=" alt="">
                GERENCIAR
            </button>
            <button class="tab-btn" onclick="switchTab('dashboard', this)">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogIDxyZWN0IHg9IjgiIHk9IjgiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgcng9IjIiLz4KICA8cmVjdCB4PSIzNiIgeT0iOCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiByeD0iMiIvPgogIDxyZWN0IHg9IjgiIHk9IjM2IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHJ4PSIyIi8+CiAgPHJlY3QgeD0iMzYiIHk9IjM2IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHJ4PSIyIi8+Cjwvc3ZnPgo=" alt="">
                PAINEL DE CONTROLE
            </button>
        </div>

        <div class="content-area">
            <!-- Tab Destinat√°rios -->
            <div id="destinatarios" class="tab-content active">
                <h2 class="form-title">Cadastrar Destinat√°rios</h2>
                <div id="alert-dest" class="alert"></div>
                
                <!-- Campo do telefone respons√°vel -->
                <div class="form-group">
                    <label>Seu Telefone (respons√°vel) <span class="required">*</span></label>
                    <div class="phone-input-group">
                        <span class="phone-prefix">+55</span>
                        <input type="text" id="tel-resp-dest" class="form-control" placeholder="11999999999" required>
                    </div>
                </div>

                <!-- Bot√£o para buscar contatos -->
                <button type="button" id="btn-buscar-evolution" class="btn-submit" onclick="buscarContatosEvolution()" style="margin-bottom: 20px; background: linear-gradient(135deg, #059669 0%, #10b981 100%); box-shadow: 0 5px 25px rgba(16, 185, 129, 0.4);">
                    üîç BUSCAR CONTATOS DO WHATSAPP
                </button>

                <!-- √Årea de filtros e lista -->
                <div id="area-contatos-evolution" style="display: none;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                        <input type="text" id="filtro-busca-evo" class="form-control" placeholder="üîç Filtrar por nome..." style="flex: 1; min-width: 200px;" oninput="filtrarContatosEvo()">
                        <select id="filtro-tipo-evo" class="form-control" style="width: auto; min-width: 140px;" onchange="filtrarContatosEvo()">
                            <option value="todos">üìã Todos</option>
                            <option value="contato">üë§ Contatos</option>
                            <option value="grupo">üë• Grupos</option>
                        </select>
                    </div>

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                        <div>
                            <span id="contador-selecionados-evo" style="color: #22c55e; font-weight: 600;">0 selecionados</span>
                            <span id="contador-total-evo" style="color: #64748b; margin-left: 10px;">de 0 encontrados</span>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="button" class="expand-btn" onclick="selecionarTodosEvo()">‚úì Selecionar vis√≠veis</button>
                            <button type="button" class="expand-btn" onclick="limparSelecaoEvo()">‚úó Limpar</button>
                        </div>
                    </div>

                    <div id="lista-contatos-evo" style="max-height: 350px; overflow-y: auto; border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; background: rgba(15, 23, 42, 0.5);"></div>

                    <button type="button" id="btn-cadastrar-evo" class="btn-submit" onclick="cadastrarSelecionadosEvo()" style="margin-top: 20px;">
                        CADASTRAR SELECIONADOS
                    </button>
                </div>

                <!-- Cadastro manual -->
                <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(59, 130, 246, 0.2);">
                    <details>
                        <summary style="cursor: pointer; color: #64748b; font-size: 0.9rem; margin-bottom: 15px;">‚ûï Cadastro manual (opcional)</summary>
                        <form id="form-destinatario" onsubmit="submitDestinatario(event)">
                            <input type="hidden" name="Telefone Responsavel" id="tel-resp-manual">
                            <div class="form-group">
                                <label>Nome do Destinat√°rio <span class="required">*</span></label>
                                <input type="text" name="Nome" class="form-control" placeholder="Nome completo" required>
                            </div>
                            <div class="form-group">
                                <label>Telefone ou ID <span class="required">*</span></label>
                                <input type="text" name="Telefone" id="tel-dest" class="form-control" placeholder="5511988888888 ou ID do grupo" required>
                            </div>
                            <button type="submit" id="btn-dest" class="btn-submit">CADASTRAR MANUAL</button>
                        </form>
                    </details>
                </div>
            </div>

            <!-- Tab Agendar -->
            <div id="agendar" class="tab-content">
                <h2 class="form-title">Agendar Disparo</h2>
                <div id="alert-agend" class="alert"></div>
                <form id="form-agendamento" onsubmit="submitAgendamento(event)">
                    <div class="form-group">
                        <label>Seu Telefone <span class="required">*</span></label>
                        <div class="phone-input-group">
                            <span class="phone-prefix">+55</span>
                            <input type="text" name="Telefone Responsavel" id="tel-resp-agend" class="form-control" placeholder="11999999999" required>
                        </div>
                        <button type="button" class="btn-buscar-dest" onclick="carregarDestinatarios()">BUSCAR DESTINAT√ÅRIOS</button>
                    </div>
                    <div class="form-group" id="destinatarios-container" style="display: none;">
                        <label>Selecione os Destinat√°rios <span class="required">*</span></label>
                        <div class="destinatarios-filtros">
                            <input type="text" id="busca-destinatario" class="form-control" placeholder="Buscar por nome..." oninput="filtrarDestinatarios()">
                            <div class="filtro-btns">
                                <button type="button" class="filtro-btn active" onclick="setFiltro('todos', this)">TODOS</button>
                                <button type="button" class="filtro-btn" onclick="setFiltro('grupo', this)">GRUPOS</button>
                                <button type="button" class="filtro-btn" onclick="setFiltro('contato', this)">CONTATOS</button>
                            </div>
                        </div>
                        <div id="destinatarios-list" class="destinatarios-list">
                            <p style="color: #64748b; font-size: 0.85rem;">Clique em "BUSCAR DESTINAT√ÅRIOS" para carregar.</p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Mensagem <span class="required">*</span></label>
                        <textarea name="Mensagem" id="mensagem-textarea" class="form-control" placeholder="Digite sua mensagem..." required></textarea>
                        <button type="button" class="expand-btn" onclick="expandTextarea()">‚Üï Expandir</button>
                    </div>
                    <div class="form-group">
                        <label>URL da Imagem (opcional)</label>
                        <input type="url" name="URL da Imagem" class="form-control" placeholder="https://exemplo.com/imagem.jpg">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Data do Disparo <span class="required">*</span></label>
                            <input type="date" name="Data do Disparo" id="data-disparo" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Hor√°rio <span class="required">*</span></label>
                            <input type="hidden" name="Hora do Disparo" id="hora-disparo">
                            <div class="time-picker-container">
                                <input type="text" id="time-picker-display" class="time-picker-input" placeholder="Clique para selecionar o hor√°rio" readonly onclick="toggleTimePicker()">
                                <div id="time-picker-dropdown" class="time-picker-dropdown">
                                    <div class="time-picker-header">
                                        <span>Selecione o hor√°rio</span>
                                        <button type="button" class="time-picker-close" onclick="closeTimePicker()">‚úï</button>
                                    </div>
                                    <div class="time-picker-columns">
                                        <div class="time-column">
                                            <div class="time-column-label">Hora</div>
                                            <div class="time-scroll" id="hour-scroll"></div>
                                        </div>
                                        <div class="time-separator">:</div>
                                        <div class="time-column">
                                            <div class="time-column-label">Minuto</div>
                                            <div class="time-scroll" id="minute-scroll"></div>
                                        </div>
                                    </div>
                                    <button type="button" class="time-picker-confirm" onclick="confirmTime()">CONFIRMAR</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recorr√™ncia -->
                    <div class="form-group">
                        <label>Repetir</label>
                        <select name="Recorrencia" id="recorrencia-select" class="form-control" onchange="toggleRecorrenciaOptions()">
                            <option value="unico">√önica vez</option>
                            <option value="diario">Diariamente</option>
                            <option value="semanal">Semanalmente</option>
                            <option value="mensal">Mensalmente</option>
                        </select>
                    </div>

                    <!-- Op√ß√µes de Semanal -->
                    <div id="opcoes-semanal" class="recorrencia-options">
                        <label style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 8px; display: block;">Dias da semana</label>
                        <div class="dias-semana-grid">
                            <div class="dia-semana-btn" data-dia="0" onclick="toggleDiaSemana(this)">Dom</div>
                            <div class="dia-semana-btn" data-dia="1" onclick="toggleDiaSemana(this)">Seg</div>
                            <div class="dia-semana-btn" data-dia="2" onclick="toggleDiaSemana(this)">Ter</div>
                            <div class="dia-semana-btn" data-dia="3" onclick="toggleDiaSemana(this)">Qua</div>
                            <div class="dia-semana-btn" data-dia="4" onclick="toggleDiaSemana(this)">Qui</div>
                            <div class="dia-semana-btn" data-dia="5" onclick="toggleDiaSemana(this)">Sex</div>
                            <div class="dia-semana-btn" data-dia="6" onclick="toggleDiaSemana(this)">S√°b</div>
                        </div>
                        <input type="hidden" name="Dias Semana" id="dias-semana-input">
                    </div>

                    <!-- Op√ß√µes de Mensal -->
                    <div id="opcoes-mensal" class="recorrencia-options">
                        <label style="color: #94a3b8; font-size: 0.9rem;">Dia do m√™s</label>
                        <input type="number" name="Dia Mes" id="dia-mes-input" class="form-control dia-mes-input" min="1" max="31" placeholder="1-31">
                    </div>

                    <button type="submit" id="btn-agend" class="btn-submit">AGENDAR DISPARO</button>
                </form>
            </div>

            <!-- Tab Gerenciar Agendados -->
            <div id="gerenciar" class="tab-content">
                <h2 class="form-title">Gerenciar Agendamentos</h2>
                <div id="alert-gerenciar" class="alert"></div>
                
                <div class="dashboard-search">
                    <div class="phone-input-group">
                        <span class="phone-prefix">+55</span>
                        <input type="text" id="gerenciar-telefone" class="form-control" placeholder="11999999999">
                    </div>
                    <button onclick="loadGerenciar()" class="btn-submit">BUSCAR</button>
                </div>

                <!-- Filtros de Status -->
                <div id="filtros-status-container" class="filtros-status" style="display: none;">
                    <button class="filtro-status-btn active" onclick="filtrarPorStatus('todos', this)">Todos</button>
                    <button class="filtro-status-btn" onclick="filtrarPorStatus('pendente', this)">‚è≥ Pendente</button>
                    <button class="filtro-status-btn" onclick="filtrarPorStatus('pausado', this)">‚è∏Ô∏è Pausado</button>
                    <button class="filtro-status-btn" onclick="filtrarPorStatus('enviado', this)">‚úÖ Enviado</button>
                    <button class="filtro-status-btn" onclick="filtrarPorStatus('erro', this)">‚ùå Erro</button>
                </div>

                <div id="gerenciar-content"></div>
            </div>

            <!-- Tab Dashboard -->
            <div id="dashboard" class="tab-content">
                <h2 class="form-title">Dashboard</h2>
                <div class="dashboard-search">
                    <div class="phone-input-group">
                        <span class="phone-prefix">+55</span>
                        <input type="text" id="dashboard-telefone" class="form-control" placeholder="11999999999">
                    </div>
                    <button onclick="loadDashboard()" class="btn-submit">BUSCAR</button>
                </div>
                <div id="dashboard-content"></div>
            </div>
        </div>

        <div class="footer">
            <p>Powered by <a href="#">AUTRIX</a></p>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o para Exclus√£o -->
    <div id="modal-confirmar-exclusao" class="modal-overlay">
        <div class="modal-content">
            <h3 class="modal-title">‚ö†Ô∏è Confirmar Exclus√£o</h3>
            <p class="modal-text">Tem certeza que deseja excluir este agendamento? Esta a√ß√£o n√£o pode ser desfeita.</p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" onclick="fecharModal()">Cancelar</button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmarExclusao()">Excluir</button>
            </div>
        </div>
    </div>

    <script>
        let statsChart = null;

        function switchTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('active');
            });

            document.getElementById(tabId).classList.add('active');
            btn.classList.add('active');
            
            document.querySelectorAll('.alert').forEach(alert => {
                alert.style.display = 'none';
            });
        }

        function expandTextarea() {
            const textarea = document.getElementById('mensagem-textarea');
            if (textarea.style.minHeight === '300px') {
                textarea.style.minHeight = '100px';
            } else {
                textarea.style.minHeight = '300px';
            }
        }

        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            alert.textContent = message;
            alert.className = 'alert alert-' + type;
            alert.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 5000);
            }
        }

        function setLoading(btnId, loading) {
            const btn = document.getElementById(btnId);
            if (loading) {
                btn.disabled = true;
                btn.innerHTML = '<span class="loading"></span> ENVIANDO...';
            } else {
                btn.disabled = false;
                btn.innerHTML = btnId === 'btn-dest' ? 'CADASTRAR' : 'AGENDAR DISPARO';
            }
        }

        let selectedHour = null;
        let selectedMinute = null;

        function initTimePicker() {
            const hourScroll = document.getElementById('hour-scroll');
            const minuteScroll = document.getElementById('minute-scroll');
            
            // Gerar horas (00-23)
            for (let h = 0; h <= 23; h++) {
                const option = document.createElement('div');
                option.className = 'time-option';
                option.textContent = h.toString().padStart(2, '0');
                option.onclick = () => selectHour(h, option);
                hourScroll.appendChild(option);
            }
            
            // Gerar minutos (00-59)
            for (let m = 0; m <= 59; m++) {
                const option = document.createElement('div');
                option.className = 'time-option';
                option.textContent = m.toString().padStart(2, '0');
                option.onclick = () => selectMinute(m, option);
                minuteScroll.appendChild(option);
            }

            // Fechar dropdown ao clicar fora
            document.addEventListener('click', (e) => {
                const dropdown = document.getElementById('time-picker-dropdown');
                const container = document.querySelector('.time-picker-container');
                if (!container.contains(e.target)) {
                    dropdown.classList.remove('open');
                }
            });
        }

        function toggleTimePicker() {
            const dropdown = document.getElementById('time-picker-dropdown');
            dropdown.classList.toggle('open');
        }

        function closeTimePicker() {
            document.getElementById('time-picker-dropdown').classList.remove('open');
        }

        function selectHour(hour, element) {
            document.querySelectorAll('#hour-scroll .time-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedHour = hour;
        }

        function selectMinute(minute, element) {
            document.querySelectorAll('#minute-scroll .time-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedMinute = minute;
        }

        function confirmTime() {
            if (selectedHour === null || selectedMinute === null) {
                alert('Selecione hora e minuto');
                return;
            }
            
            const timeStr = `${selectedHour.toString().padStart(2, '0')}:${selectedMinute.toString().padStart(2, '0')}`;
            document.getElementById('hora-disparo').value = timeStr;
            document.getElementById('time-picker-display').value = `‚è∞ ${timeStr}`;
            closeTimePicker();
        }

        function clearTime() {
            selectedHour = null;
            selectedMinute = null;
            document.querySelectorAll('.time-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.getElementById('hora-disparo').value = '';
            document.getElementById('time-picker-display').value = '';
        }

        // Fun√ß√µes de Recorr√™ncia
        function toggleRecorrenciaOptions() {
            const recorrencia = document.getElementById('recorrencia-select').value;
            const opcoesSemanal = document.getElementById('opcoes-semanal');
            const opcoesMensal = document.getElementById('opcoes-mensal');
            
            opcoesSemanal.classList.remove('show');
            opcoesMensal.classList.remove('show');
            
            if (recorrencia === 'semanal') {
                opcoesSemanal.classList.add('show');
            } else if (recorrencia === 'mensal') {
                opcoesMensal.classList.add('show');
            }
        }

        function toggleDiaSemana(element) {
            element.classList.toggle('selected');
            updateDiasSemanaInput();
        }

        function updateDiasSemanaInput() {
            const selectedDias = [];
            document.querySelectorAll('.dia-semana-btn.selected').forEach(btn => {
                selectedDias.push(parseInt(btn.dataset.dia));
            });
            document.getElementById('dias-semana-input').value = JSON.stringify(selectedDias);
        }

        function clearRecorrencia() {
            document.getElementById('recorrencia-select').value = 'unico';
            document.getElementById('opcoes-semanal').classList.remove('show');
            document.getElementById('opcoes-mensal').classList.remove('show');
            document.querySelectorAll('.dia-semana-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.getElementById('dias-semana-input').value = '';
            document.getElementById('dia-mes-input').value = '';
        }

        // ========== FUN√á√ïES BUSCA EVOLUTION API ==========
        let todosContatosEvo = [];
        let selecionadosEvo = new Set();

        async function buscarContatosEvolution() {
            const telResp = document.getElementById('tel-resp-dest').value.replace(/\D/g, '');
            if (!telResp || telResp.length < 10) {
                showAlert('alert-dest', '‚úó Digite seu telefone antes de buscar.', 'error');
                return;
            }

            const btn = document.getElementById('btn-buscar-evolution');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> BUSCANDO...';

            try {
                const response = await fetch('https://workflow.autrix.com.br/webhook/buscar-evolution');
                if (!response.ok) throw new Error('Erro');
                
                todosContatosEvo = await response.json();
                selecionadosEvo.clear();
                
                document.getElementById('area-contatos-evolution').style.display = 'block';
                renderizarContatosEvo(todosContatosEvo);
                atualizarContadoresEvo();
                
                showAlert('alert-dest', `‚úì ${todosContatosEvo.length} contatos/grupos encontrados!`, 'success');
            } catch (error) {
                showAlert('alert-dest', '‚úó Erro ao buscar. Tente novamente.', 'error');
            }

            btn.disabled = false;
            btn.innerHTML = 'üîç BUSCAR CONTATOS DO WHATSAPP';
        }

        function renderizarContatosEvo(contatos) {
            const lista = document.getElementById('lista-contatos-evo');
            if (contatos.length === 0) {
                lista.innerHTML = '<div style="padding: 20px; text-align: center; color: #64748b;">Nenhum contato encontrado</div>';
                return;
            }

            lista.innerHTML = contatos.map(c => `
                <div class="contato-evo-item" data-numero="${c.numero}" data-nome="${c.nome}" data-tipo="${c.tipo}"
                     style="display: flex; align-items: center; padding: 12px 15px; border-bottom: 1px solid rgba(59, 130, 246, 0.1); cursor: pointer; transition: background 0.2s; background: ${selecionadosEvo.has(c.numero) ? 'rgba(34, 197, 94, 0.15)' : 'transparent'};"
                     onclick="toggleContatoEvo(this)">
                    <div style="width: 22px; height: 22px; border: 2px solid ${selecionadosEvo.has(c.numero) ? '#22c55e' : 'rgba(59, 130, 246, 0.5)'}; border-radius: 4px; margin-right: 12px; display: flex; align-items: center; justify-content: center; background: ${selecionadosEvo.has(c.numero) ? 'rgba(34, 197, 94, 0.3)' : 'transparent'};">
                        ${selecionadosEvo.has(c.numero) ? '<span style="color: #22c55e; font-weight: bold;">‚úì</span>' : ''}
                    </div>
                    <div style="flex: 1; overflow: hidden;">
                        <div style="font-weight: 500; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${escapeHtml(c.nome)}</div>
                        <div style="font-size: 0.7rem; color: #64748b;">${c.numero}</div>
                    </div>
                    <div style="padding: 3px 8px; border-radius: 10px; font-size: 0.65rem; font-weight: 600; ${c.tipo === 'grupo' ? 'background: rgba(139, 92, 246, 0.2); color: #a78bfa;' : 'background: rgba(59, 130, 246, 0.2); color: #60a5fa;'}">
                        ${c.tipo === 'grupo' ? 'üë• GRUPO' : 'üë§'}
                    </div>
                </div>
            `).join('');
        }

        function toggleContatoEvo(el) {
            const numero = el.dataset.numero;
            if (selecionadosEvo.has(numero)) {
                selecionadosEvo.delete(numero);
            } else {
                selecionadosEvo.add(numero);
            }
            filtrarContatosEvo();
            atualizarContadoresEvo();
        }

        function filtrarContatosEvo() {
            const busca = document.getElementById('filtro-busca-evo').value.toLowerCase();
            const tipo = document.getElementById('filtro-tipo-evo').value;
            
            const filtrados = todosContatosEvo.filter(c => {
                const matchNome = c.nome.toLowerCase().includes(busca);
                const matchTipo = tipo === 'todos' || c.tipo === tipo;
                return matchNome && matchTipo;
            });
            
            renderizarContatosEvo(filtrados);
            document.getElementById('contador-total-evo').textContent = `de ${filtrados.length} encontrados`;
        }

        function selecionarTodosEvo() {
            document.querySelectorAll('.contato-evo-item').forEach(el => {
                selecionadosEvo.add(el.dataset.numero);
            });
            filtrarContatosEvo();
            atualizarContadoresEvo();
        }

        function limparSelecaoEvo() {
            selecionadosEvo.clear();
            filtrarContatosEvo();
            atualizarContadoresEvo();
        }

        function atualizarContadoresEvo() {
            document.getElementById('contador-selecionados-evo').textContent = `${selecionadosEvo.size} selecionados`;
        }

        async function cadastrarSelecionadosEvo() {
            if (selecionadosEvo.size === 0) {
                showAlert('alert-dest', '‚úó Selecione pelo menos um contato.', 'error');
                return;
            }

            const telResp = '55' + document.getElementById('tel-resp-dest').value.replace(/\D/g, '');
            const btn = document.getElementById('btn-cadastrar-evo');
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> CADASTRANDO...';

            let sucesso = 0, erro = 0;

            for (const numero of selecionadosEvo) {
                const contato = todosContatosEvo.find(c => c.numero === numero);
                if (!contato) continue;

                try {
                    const response = await fetch('https://workflow.autrix.com.br/webhook/cadastro-destinatario', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            'Telefone Responsavel': telResp,
                            'Nome': contato.nome,
                            'Telefone': contato.numero
                        })
                    });
                    if (response.ok) sucesso++; else erro++;
                } catch (e) { erro++; }
            }

            btn.disabled = false;
            btn.innerHTML = 'CADASTRAR SELECIONADOS';

            if (erro === 0) {
                showAlert('alert-dest', `‚úì ${sucesso} destinat√°rios cadastrados!`, 'success');
                selecionadosEvo.clear();
                filtrarContatosEvo();
                atualizarContadoresEvo();
            } else {
                showAlert('alert-dest', `‚ö† ${sucesso} ok, ${erro} com erro.`, 'error');
            }
        }
        // ========== FIM FUN√á√ïES EVOLUTION ==========

        async function submitDestinatario(event) {
            event.preventDefault();
            
            // Pegar telefone do campo principal
            document.getElementById('tel-resp-manual').value = document.getElementById('tel-resp-dest').value;
            
            setLoading('btn-dest', true);
            
            const form = document.getElementById('form-destinatario');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            // Adicionar prefixo 55 no telefone respons√°vel
            data['Telefone Responsavel'] = '55' + data['Telefone Responsavel'].replace(/\D/g, '');
            // Telefone/ID do destinat√°rio: manter como digitado (pode ser ID de grupo)
            data['Telefone'] = data['Telefone'].trim();

            try {
                const response = await fetch('https://workflow.autrix.com.br/webhook/cadastro-destinatario', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showAlert('alert-dest', '‚úì Destinat√°rio cadastrado com sucesso!', 'success');
                    form.reset();
                } else {
                    throw new Error('Erro no servidor');
                }
            } catch (error) {
                showAlert('alert-dest', '‚úó Erro ao cadastrar. Verifique os dados e tente novamente.', 'error');
            }
            
            setLoading('btn-dest', false);
        }

        // Carregar destinat√°rios cadastrados
        let todosDestinatarios = []; // Armazena todos os destinat√°rios carregados
        let filtroAtual = 'todos';

        async function carregarDestinatarios() {
            const telefone = '55' + document.getElementById('tel-resp-agend').value;
            if (telefone.length < 13) return;
            
            const container = document.getElementById('destinatarios-container');
            const list = document.getElementById('destinatarios-list');
            
            list.innerHTML = '<p style="color: #64748b;">Carregando destinat√°rios...</p>';
            container.style.display = 'block';
            
            try {
                const response = await fetch(`https://workflow.autrix.com.br/webhook/listar-destinatarios?telefone=${telefone}`);
                const data = await response.json();
                
                if (data && data.length > 0) {
                    todosDestinatarios = data;
                    filtroAtual = 'todos';
                    document.getElementById('busca-destinatario').value = '';
                    // Reset bot√µes de filtro
                    document.querySelectorAll('.filtro-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelector('.filtro-btn').classList.add('active');
                    renderizarDestinatarios(data);
                } else {
                    todosDestinatarios = [];
                    list.innerHTML = '<p style="color: #f59e0b;">Nenhum destinat√°rio cadastrado. Cadastre primeiro na aba CADASTRO.</p>';
                }
            } catch (error) {
                todosDestinatarios = [];
                list.innerHTML = '<p style="color: #ef4444;">Erro ao carregar destinat√°rios.</p>';
            }
        }

        function renderizarDestinatarios(destinatarios) {
            const list = document.getElementById('destinatarios-list');
            if (destinatarios.length === 0) {
                list.innerHTML = '<p style="color: #64748b;">Nenhum destinat√°rio encontrado com esse filtro.</p>';
                return;
            }
            list.innerHTML = destinatarios.map(dest => `
                <label class="destinatario-item" data-tipo="${dest.tipo || 'contato'}" data-nome="${dest.nome.toLowerCase()}" onclick="toggleDestinatario(this)">
                    <input type="checkbox" name="destinatarios[]" value="${dest.id}">
                    <div class="destinatario-info">
                        <div class="destinatario-nome">${dest.nome}</div>
                        <div class="destinatario-numero">${dest.numero}</div>
                    </div>
                    <span class="destinatario-tipo">${dest.tipo || 'contato'}</span>
                </label>
            `).join('');
        }

        function setFiltro(tipo, btn) {
            filtroAtual = tipo;
            document.querySelectorAll('.filtro-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            filtrarDestinatarios();
        }

        function filtrarDestinatarios() {
            const busca = document.getElementById('busca-destinatario').value.toLowerCase();
            
            let filtrados = todosDestinatarios.filter(dest => {
                const tipoMatch = filtroAtual === 'todos' || dest.tipo === filtroAtual;
                const nomeMatch = dest.nome.toLowerCase().includes(busca);
                return tipoMatch && nomeMatch;
            });
            
            renderizarDestinatarios(filtrados);
        }

        function toggleDestinatario(element) {
            element.classList.toggle('selected');
        }

        function getDestinatariosSelecionados() {
            const checkboxes = document.querySelectorAll('input[name="destinatarios[]"]:checked');
            return Array.from(checkboxes).map(cb => parseInt(cb.value));
        }

        async function submitAgendamento(event) {
            event.preventDefault();
            
            if (!document.getElementById('hora-disparo').value) {
                showAlert('alert-agend', '‚úó Selecione um hor√°rio para o disparo.', 'error');
                return;
            }

            const destinatarios = getDestinatariosSelecionados();
            if (destinatarios.length === 0) {
                showAlert('alert-agend', '‚úó Selecione pelo menos um destinat√°rio.', 'error');
                return;
            }

            const recorrencia = document.getElementById('recorrencia-select').value;
            
            // Valida√ß√µes de recorr√™ncia
            if (recorrencia === 'semanal') {
                const diasSelecionados = document.querySelectorAll('.dia-semana-btn.selected');
                if (diasSelecionados.length === 0) {
                    showAlert('alert-agend', '‚úó Selecione pelo menos um dia da semana.', 'error');
                    return;
                }
            }
            
            if (recorrencia === 'mensal') {
                const diaMes = document.getElementById('dia-mes-input').value;
                if (!diaMes || diaMes < 1 || diaMes > 31) {
                    showAlert('alert-agend', '‚úó Informe um dia do m√™s v√°lido (1-31).', 'error');
                    return;
                }
            }
            
            setLoading('btn-agend', true);
            
            const form = document.getElementById('form-agendamento');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            // Adicionar prefixo 55
            data['Telefone Responsavel'] = '55' + data['Telefone Responsavel'].replace(/\D/g, '');
            
            if (data['Data do Disparo']) {
                const [year, month, day] = data['Data do Disparo'].split('-');
                data['Data do Disparo'] = `${day}/${month}/${year}`;
            }

            // Processar campos de recorr√™ncia
            if (data['Dias Semana']) {
                data['Dias Semana'] = JSON.parse(data['Dias Semana']);
            } else {
                data['Dias Semana'] = null;
            }
            
            if (data['Dia Mes']) {
                data['Dia Mes'] = parseInt(data['Dia Mes']);
            } else {
                data['Dia Mes'] = null;
            }

            // Adicionar destinat√°rios selecionados
            data['Destinatarios'] = destinatarios;
            delete data['destinatarios[]'];

            try {
                const response = await fetch('https://workflow.autrix.com.br/webhook/agendar-disparo', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showAlert('alert-agend', '‚úì Disparo agendado com sucesso!', 'success');
                    form.reset();
                    clearTime();
                    clearRecorrencia();
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('data-disparo').value = today;
                    
                    // Limpar sele√ß√£o de destinat√°rios
                    document.getElementById('destinatarios-container').style.display = 'none';
                    document.getElementById('destinatarios-list').innerHTML = '<p style="color: #64748b; font-size: 0.85rem;">Clique em "BUSCAR DESTINAT√ÅRIOS" para carregar.</p>';
                } else {
                    throw new Error('Erro no servidor');
                }
            } catch (error) {
                showAlert('alert-agend', '‚úó Erro ao agendar. Verifique os dados e tente novamente.', 'error');
            }
            
            setLoading('btn-agend', false);
        }

        // ========== FUN√á√ïES GERENCIAR AGENDADOS ==========
        let todosAgendamentosGerenciar = [];
        let filtroStatusAtual = 'todos';
        let agendamentoParaExcluir = null;

        async function loadGerenciar() {
            const telefone = '55' + document.getElementById('gerenciar-telefone').value.replace(/\D/g, '');
            if (telefone.length < 4) {
                showAlert('alert-gerenciar', '‚úó Digite seu telefone', 'error');
                return;
            }
            
            const content = document.getElementById('gerenciar-content');
            content.innerHTML = '<div style="text-align: center; padding: 40px; color: #64748b;"><span class="loading"></span> Carregando...</div>';
            
            try {
                const response = await fetch(`https://workflow.autrix.com.br/webhook/listar-agendamentos?telefone=${telefone}`);
                const rawData = await response.json();

                // Nova estrutura: [{agendamentos: [...], estatisticas: {...}}]
                const result = Array.isArray(rawData) && rawData[0] ? rawData[0] : rawData;
                const data = result.agendamentos || [];

                if (!data || data.length === 0) {
                    document.getElementById('filtros-status-container').style.display = 'none';
                    content.innerHTML = `
                        <div class="empty-state">
                            <p>üì≠ Nenhum agendamento encontrado para este telefone.</p>
                            <p style="font-size: 0.85rem;">Crie um novo na aba "Agendar / Enviar"</p>
                        </div>
                    `;
                    return;
                }

                todosAgendamentosGerenciar = data;
                filtroStatusAtual = 'todos';
                
                // Mostrar filtros
                document.getElementById('filtros-status-container').style.display = 'flex';
                document.querySelectorAll('.filtro-status-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.filtro-status-btn').classList.add('active');
                
                renderizarAgendamentos(data);

            } catch (error) {
                console.error('Erro:', error);
                content.innerHTML = `
                    <div class="empty-state" style="border-color: rgba(239, 68, 68, 0.3);">
                        <p style="color: #ef4444;">‚ùå Erro ao buscar agendamentos. Tente novamente.</p>
                    </div>
                `;
            }
        }

        function filtrarPorStatus(status, btn) {
            filtroStatusAtual = status;
            document.querySelectorAll('.filtro-status-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            let filtrados = todosAgendamentosGerenciar;
            if (status !== 'todos') {
                filtrados = todosAgendamentosGerenciar.filter(a => a.status === status);
            }
            
            renderizarAgendamentos(filtrados);
        }

        function renderizarAgendamentos(agendamentos) {
            const content = document.getElementById('gerenciar-content');
            
            if (agendamentos.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <p>Nenhum agendamento com este filtro.</p>
                    </div>
                `;
                return;
            }

            let html = `<p style="color: #94a3b8; margin-bottom: 15px; font-size: 0.9rem;">${agendamentos.length} agendamento(s) encontrado(s)</p>`;
            
            agendamentos.forEach(item => {
                const dataDisparo = formatDateBR(item.data_disparo);
                const dataCriacao = formatDateBR(item.criado_em);
                const dataEnvio = item.enviado_em ? formatDateBR(item.enviado_em) : '-';
                
                let imageHtml = '';
                if (item.image_url && item.image_url.trim() !== '') {
                    imageHtml = `<div class="agendamento-imagem"><img src="${item.image_url}" onerror="this.style.display='none'"></div>`;
                }

                // Determinar bot√µes de a√ß√£o baseado no status
                let acoesHtml = '';
                if (item.status === 'pendente') {
                    acoesHtml = `
                        <button class="btn-acao btn-pausar" onclick="executarAcao(${item.id}, 'pausar', this)">
                            ‚è∏Ô∏è Pausar
                        </button>
                        <button class="btn-acao btn-excluir" onclick="abrirModalExclusao(${item.id})">
                            üóëÔ∏è Excluir
                        </button>
                    `;
                } else if (item.status === 'pausado') {
                    acoesHtml = `
                        <button class="btn-acao btn-reativar" onclick="executarAcao(${item.id}, 'reativar', this)">
                            ‚ñ∂Ô∏è Reativar
                        </button>
                        <button class="btn-acao btn-excluir" onclick="abrirModalExclusao(${item.id})">
                            üóëÔ∏è Excluir
                        </button>
                    `;
                } else if (item.status === 'enviado' || item.status === 'erro') {
                    acoesHtml = `
                        <button class="btn-acao btn-excluir" onclick="abrirModalExclusao(${item.id})">
                            üóëÔ∏è Excluir
                        </button>
                    `;
                }
                
                html += `
                    <div class="agendamento-card" id="card-${item.id}">
                        <div class="agendamento-header">
                            <span class="agendamento-id">#${item.id}</span>
                            <span class="agendamento-status status-${item.status}">${item.status}</span>
                        </div>
                        <p class="agendamento-mensagem">${escapeHtml(item.mensagem)}</p>
                        ${imageHtml}
                        <div class="agendamento-meta">
                            <span>üìÖ Disparo: ${dataDisparo}</span>
                            <span>üïê Criado: ${dataCriacao}</span>
                            <span>‚úì Enviado: ${dataEnvio}</span>
                            <span>üë• Dest: ${item.total_destinatarios || 0}</span>
                        </div>
                        <div class="agendamento-acoes">
                            ${acoesHtml}
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = html;
        }

        async function executarAcao(agendamentoId, acao, btn) {
            const telefone = '55' + document.getElementById('gerenciar-telefone').value.replace(/\D/g, '');
            
            btn.disabled = true;
            const textoOriginal = btn.innerHTML;
            btn.innerHTML = '<span class="loading"></span>';
            
            try {
                const response = await fetch('https://workflow.autrix.com.br/webhook/gerenciar-agendamento', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        telefone: telefone,
                        agendamento_id: agendamentoId,
                        acao: acao
                    })
                });

                const result = await response.json();

                if (result.sucesso) {
                    showAlert('alert-gerenciar', `‚úì ${acao === 'pausar' ? 'Agendamento pausado' : 'Agendamento reativado'} com sucesso!`, 'success');
                    // Recarregar lista
                    await loadGerenciar();
                } else {
                    throw new Error(result.mensagem || 'Erro ao executar a√ß√£o');
                }
            } catch (error) {
                showAlert('alert-gerenciar', `‚úó Erro: ${error.message}`, 'error');
                btn.disabled = false;
                btn.innerHTML = textoOriginal;
            }
        }

        function abrirModalExclusao(agendamentoId) {
            agendamentoParaExcluir = agendamentoId;
            document.getElementById('modal-confirmar-exclusao').classList.add('active');
        }

        function fecharModal() {
            document.getElementById('modal-confirmar-exclusao').classList.remove('active');
            agendamentoParaExcluir = null;
        }

        async function confirmarExclusao() {
            if (!agendamentoParaExcluir) return;
            
            const telefone = '55' + document.getElementById('gerenciar-telefone').value.replace(/\D/g, '');
            
            fecharModal();
            
            try {
                const response = await fetch('https://workflow.autrix.com.br/webhook/gerenciar-agendamento', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        telefone: telefone,
                        agendamento_id: agendamentoParaExcluir,
                        acao: 'excluir'
                    })
                });

                const result = await response.json();

                if (result.sucesso) {
                    showAlert('alert-gerenciar', '‚úì Agendamento exclu√≠do com sucesso!', 'success');
                    // Remover card com anima√ß√£o
                    const card = document.getElementById(`card-${agendamentoParaExcluir}`);
                    if (card) {
                        card.style.opacity = '0';
                        card.style.transform = 'translateX(-20px)';
                        setTimeout(() => {
                            // Recarregar lista
                            loadGerenciar();
                        }, 300);
                    } else {
                        await loadGerenciar();
                    }
                } else {
                    throw new Error(result.mensagem || 'Erro ao excluir');
                }
            } catch (error) {
                showAlert('alert-gerenciar', `‚úó Erro: ${error.message}`, 'error');
            }
            
            agendamentoParaExcluir = null;
        }
        // ========== FIM FUN√á√ïES GERENCIAR AGENDADOS ==========

        async function loadDashboard() {
            const telefone = '55' + document.getElementById('dashboard-telefone').value.replace(/\D/g, '');
            if (telefone.length < 4) {
                alert('Digite seu telefone');
                return;
            }
            
            const content = document.getElementById('dashboard-content');
            content.innerHTML = '<div style="text-align: center; padding: 40px; color: #64748b;"><span class="loading"></span> Carregando...</div>';
            
            try {
                const response = await fetch(`https://workflow.autrix.com.br/webhook/listar-agendamentos?telefone=${telefone}`);
                const rawData = await response.json();

                // Nova estrutura: [{agendamentos: [...], estatisticas: {...}}]
                const result = Array.isArray(rawData) && rawData[0] ? rawData[0] : rawData;
                const data = result.agendamentos || [];
                const stats = result.estatisticas || {};

                if (!data || data.length === 0) {
                    content.innerHTML = `
                        <div style="text-align: center; padding: 30px; color: #64748b; border: 1px dashed rgba(59, 130, 246, 0.3); border-radius: 8px;">
                            <p>Nenhum agendamento encontrado para este telefone.</p>
                        </div>
                    `;
                    return;
                }

                // Renderizar estat√≠sticas
                let html = renderStats(stats);
                
                // Renderizar gr√°ficos
                html += renderCharts();
                
                // Lista de agendamentos
                html += `<p style="color: #94a3b8; margin-bottom: 15px; font-size: 0.9rem;">${data.length} agendamento(s) encontrado(s)</p>`;
                
                data.forEach(item => {
                    const statusColors = {
                        'pendente': 'background: rgba(251, 191, 36, 0.2); color: #fbbf24;',
                        'pausado': 'background: rgba(251, 191, 36, 0.2); color: #fbbf24; border: 1px dashed #fbbf24;',
                        'processando': 'background: rgba(59, 130, 246, 0.2); color: #3b82f6;',
                        'enviado': 'background: rgba(34, 197, 94, 0.2); color: #22c55e;',
                        'erro': 'background: rgba(239, 68, 68, 0.2); color: #ef4444;'
                    };
                    const statusStyle = statusColors[item.status] || statusColors['pendente'];
                    
                    const dataDisparo = formatDateBR(item.data_disparo);
                    const dataCriacao = formatDateBR(item.criado_em);
                    const dataEnvio = item.enviado_em ? formatDateBR(item.enviado_em) : '-';
                    
                    let imageHtml = '';
                    if (item.image_url && item.image_url.trim() !== '') {
                        imageHtml = `<div style="margin: 10px 0;"><img src="${item.image_url}" style="max-width: 150px; max-height: 100px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.1);" onerror="this.style.display='none'"></div>`;
                    }
                    
                    html += `
                        <div style="background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <span style="color: #64748b; font-size: 0.85rem;">#${item.id}</span>
                                <span style="padding: 5px 12px; border-radius: 15px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; ${statusStyle}">${item.status}</span>
                            </div>
                            <p style="color: #e2e8f0; font-size: 1rem; margin-bottom: 10px; word-break: break-word;">${escapeHtml(item.mensagem)}</p>
                            ${imageHtml}
                            <div style="display: flex; flex-wrap: wrap; gap: 15px; font-size: 0.8rem; color: #64748b; margin-top: 12px;">
                                <span>üìÖ Disparo: ${dataDisparo}</span>
                                <span>üïê Criado: ${dataCriacao}</span>
                                <span>‚úì Enviado: ${dataEnvio}</span>
                                <span>üë• Dest: ${item.total_destinatarios || 0}</span>
                            </div>
                        </div>
                    `;
                });
                
                content.innerHTML = html;
                
                // Inicializar gr√°ficos ap√≥s renderizar
                initCharts(stats);

            } catch (error) {
                console.error('Erro:', error);
                content.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #ef4444; border: 1px dashed rgba(239, 68, 68, 0.3); border-radius: 8px;">
                        <p>Erro ao buscar agendamentos. Tente novamente.</p>
                    </div>
                `;
            }
        }

        function renderStats(stats) {
            const totalEnviados = parseInt(stats.total_enviados) || 0;
            const totalErros = parseInt(stats.total_erros) || 0;
            const taxaSucesso = stats.taxa_sucesso || 0;
            const totalDest = parseInt(stats.total_destinatarios) || 0;
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${totalEnviados}</div>
                        <div class="stat-label">Enviados</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value">${taxaSucesso}%</div>
                        <div class="stat-label">Taxa Sucesso</div>
                    </div>
                    <div class="stat-card error">
                        <div class="stat-value">${totalErros}</div>
                        <div class="stat-label">Erros</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${totalDest}</div>
                        <div class="stat-label">Destinat√°rios</div>
                    </div>
                </div>
            `;
        }

        function renderCharts() {
            return `
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-tabs">
                            <button class="chart-tab active" onclick="showChart('semana', this)">Semana</button>
                            <button class="chart-tab" onclick="showChart('mes', this)">M√™s</button>
                            <button class="chart-tab" onclick="showChart('ano', this)">Ano</button>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="statsChart"></canvas>
                        </div>
                    </div>
                </div>
            `;
        }

        let currentChartData = {};

        function initCharts(stats) {
            currentChartData = {
                semana: {
                    labels: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'],
                    data: stats.semana || [0, 0, 0, 0, 0, 0, 0]
                },
                mes: {
                    labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4', 'Sem 5'],
                    data: stats.mes || [0, 0, 0, 0, 0]
                },
                ano: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    data: stats.ano || [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                }
            };
            
            showChart('semana', document.querySelector('.chart-tab.active'));
        }

        function showChart(period, btn) {
            document.querySelectorAll('.chart-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            
            const ctx = document.getElementById('statsChart');
            if (!ctx) return;
            
            if (statsChart) {
                statsChart.destroy();
            }
            
            const chartData = currentChartData[period];
            
            statsChart = new Chart(ctx, {
                type: period === 'ano' ? 'line' : 'bar',
                data: {
                    labels: chartData.labels,
                    datasets: [{
                        label: 'Envios',
                        data: chartData.data,
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: '#3b82f6',
                        borderWidth: 2,
                        borderRadius: 4,
                        tension: 0.3,
                        fill: period === 'ano'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#64748b'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#64748b'
                            }
                        }
                    }
                }
            });
        }

        function formatDateBR(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('data-disparo').setAttribute('min', today);
            document.getElementById('data-disparo').value = today;
            initTimePicker();
        });
    </script>
</body>
</html>
